name: $(Year:yyyy).$(Month).$(DayOfMonth)$(Rev:.r)

variables:
  projects: 'database/bizca.dacpac/bizca.dacpac.sqlproj'
  artifactName: "dacpac"
  buildConfiguration: 'Release'

trigger:
  branches:
    include: [ 'develop', 'master', 'feature', 'release/*', 'hotfix/*' ]
  paths:
    include: [ 'database/bizca.dacpac' ]


steps:
- task: DotNetCoreCLI@2
  displayName: 'build dacpac'
  inputs:
    command: build
    configuration: '$(buildConfiguration)'
    projects: '$(projects)'
    workingDirectory: '$(System.DefaultWorkingDirectory)'

- script: 'ls -r $(System.DefaultWorkingDirectory)'
  displayName: 'display folder $(System.DefaultWorkingDirectory)'

- script: 'ls -r $(build.ArtifactStagingDirectory)'
  displayName: 'display folder $(build.ArtifactStagingDirectory)'

#- task: CopyFiles@2
#  displayName: 'copy dacpac'
#  inputs:
#    SourceFolder: '$(Build.BinariesDirectory)'
#    Contents: |
#      *.dacpac
#    TargetFolder: '$(build.ArtifactStagingDirectory)'
#    OverWrite: true
#
#- task: PublishBuildArtifacts@1
#  inputs:
#    PathtoPublish: '$(Build.ArtifactStagingDirectory)'
#    ArtifactName: '$(artifactName)'
#    publishLocation: 'Container'
#